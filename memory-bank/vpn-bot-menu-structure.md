# VPN Telegram Bot - –ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ –º–µ–Ω—é –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

## üó∫Ô∏è –û–ë–©–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –ù–ê–í–ò–ì–ê–¶–ò–ò

```mermaid
graph TD
    Start["/start<br>üöÄ –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞"] --> Auth["Mock –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è<br>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è user_id"]
    Auth --> MainMenu["üè† –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ<br>8 –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤"]
    
    %% –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã
    MainMenu --> MyVPN["üîê –ú–æ–π VPN"]
    MainMenu --> Subs["üí≥ –ü–æ–¥–ø–∏—Å–∫–∏"]
    MainMenu --> Stats["üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"]
    MainMenu --> Payments["üí∞ –ü–ª–∞—Ç–µ–∂–∏"]
    MainMenu --> Profile["üë§ –ü—Ä–æ—Ñ–∏–ª—å"]
    MainMenu --> Support["üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞"]
    MainMenu --> Help["‚ÑπÔ∏è –ü–æ–º–æ—â—å"]
    MainMenu --> Admin["üë®‚Äçüíª –ê–¥–º–∏–Ω"]
    
    %% –ú–æ–π VPN —Ä–∞–∑–¥–µ–ª
    MyVPN --> VPNCheck{"–ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è<br>–ø–æ–¥–ø–∏—Å–∫–∞?"}
    VPNCheck -->|"–ù–µ—Ç"| NoSub["‚ùå –ù–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏<br>–ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø–æ–∫—É–ø–∫–µ"]
    VPNCheck -->|"–î–∞"| VPNActions["üîê VPN –î–ï–ô–°–¢–í–ò–Ø"]
    
    VPNActions --> GetConfig["üì± –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"]
    VPNActions --> GetQR["üì∑ QR-–∫–æ–¥"]
    VPNActions --> RegenKey["üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∫–ª—é—á"]
    VPNActions --> VPNStats["üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ VPN"]
    
    %% –ü–æ–¥–ø–∏—Å–∫–∏ —Ä–∞–∑–¥–µ–ª
    Subs --> SubsMenu["üí≥ –í–´–ë–û–† –¢–ê–†–ò–§–ê"]
    SubsMenu --> Trial["üÜì –ü—Ä–æ–±–Ω–∞—è (7 –¥–Ω–µ–π)"]
    SubsMenu --> Monthly["üìÖ –ú–µ—Å—è—á–Ω–∞—è (299‚ÇΩ)"]
    SubsMenu --> Quarterly["üìÖ –ö–≤–∞—Ä—Ç–∞–ª—å–Ω–∞—è (799‚ÇΩ)"]
    SubsMenu --> Yearly["üìÖ –ì–æ–¥–æ–≤–∞—è (2999‚ÇΩ)"]
    
    %% –°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã
    Monthly --> PayMethods["üí≥ –°–ü–û–°–û–ë–´ –û–ü–õ–ê–¢–´"]
    Quarterly --> PayMethods
    Yearly --> PayMethods
    
    PayMethods --> PayCard["üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞"]
    PayMethods --> PaySBP["‚ö° –°–ë–ü"]
    PayMethods --> PayWallet["üíº –ö–æ—à–µ–ª—å–∫–∏"]
    PayMethods --> PayCrypto["‚Çø –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞"]
    
    %% –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
    Admin --> AdminCheck{"–ê–¥–º–∏–Ω—Å–∫–∏–µ<br>–ø—Ä–∞–≤–∞?"}
    AdminCheck -->|"–ù–µ—Ç"| AccessDenied["‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω"]
    AdminCheck -->|"–î–∞"| AdminPanel["üîß –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨"]
    
    AdminPanel --> AdminStats["üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã"]
    AdminPanel --> UserMgmt["üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"]
    AdminPanel --> SubMgmt["üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏"]
    AdminPanel --> UserSearch["üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"]
    AdminPanel --> GiveSub["üéÅ –í—ã–¥–∞—á–∞ –ø–æ–¥–ø–∏—Å–∫–∏"]
    AdminPanel --> SysInfo["‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ"]
    
    %% –°—Ç–∏–ª–∏
    style Start fill:#4da6ff,stroke:#0066cc,color:white
    style MainMenu fill:#10b981,stroke:#059669,color:white
    style VPNActions fill:#f59e0b,stroke:#d97706,color:white
    style SubsMenu fill:#8b5cf6,stroke:#7c3aed,color:white
    style PayMethods fill:#ef4444,stroke:#dc2626,color:white
    style AdminPanel fill:#6366f1,stroke:#4f46e5,color:white
```

## üè† –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### 1. üîê –ú–æ–π VPN
**Handler**: `menu.py:my_vpn_handler`  
**Callback**: `"my_vpn"`

```mermaid
graph TD
    MyVPN["üîê –ú–æ–π VPN"] --> CheckSub{"–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π<br>–ø–æ–¥–ø–∏—Å–∫–∏"}
    
    CheckSub -->|"–ü–æ–¥–ø–∏—Å–∫–∞ –µ—Å—Ç—å"| CheckKeys{"VPN –∫–ª—é—á–∏<br>–¥–æ—Å—Ç—É–ø–Ω—ã?"}
    CheckSub -->|"–ù–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏"| NoSubMsg["‚ùå –£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏<br>–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∫—É–ø–∏—Ç—å"]
    
    CheckKeys -->|"–ö–ª—é—á–∏ –µ—Å—Ç—å"| ShowVPN["üîê –ü–æ–∫–∞–∑–∞—Ç—å VPN –¥–∞–Ω–Ω—ã–µ<br>+ VPN Actions –º–µ–Ω—é"]
    CheckKeys -->|"–ù–µ—Ç –∫–ª—é—á–µ–π"| VPNError["‚ö†Ô∏è –ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞,<br>–Ω–æ –∫–ª—é—á –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"]
    
    ShowVPN --> VPNActionsMenu["üì± –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é<br>üì∑ QR-–∫–æ–¥<br>üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∫–ª—é—á<br>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"]
    
    NoSubMsg --> SubMenu["üí≥ –ü–æ–¥–ø–∏—Å–∫–∏"]
    VPNError --> BackBtn["‚Ü©Ô∏è –ù–∞–∑–∞–¥"]
    
    style CheckSub fill:#fbbf24,stroke:#f59e0b,color:white
    style ShowVPN fill:#10b981,stroke:#059669,color:white
    style NoSubMsg fill:#ef4444,stroke:#dc2626,color:white
```

### 2. üí≥ –ü–æ–¥–ø–∏—Å–∫–∏
**Handler**: `subscriptions.py` (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ handlers)  
**Callback**: `"subscriptions"`

```mermaid
graph TD
    Subscriptions["üí≥ –ü–æ–¥–ø–∏—Å–∫–∏"] --> SubPlans["4 –¢–ê–†–ò–§–ù–´–• –ü–õ–ê–ù–ê"]
    
    SubPlans --> Trial["üÜì –ü—Ä–æ–±–Ω–∞—è<br>(7 –¥–Ω–µ–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ)"]
    SubPlans --> Monthly["üìÖ –ú–µ—Å—è—á–Ω–∞—è<br>(299‚ÇΩ / –º–µ—Å—è—Ü)"]
    SubPlans --> Quarterly["üìÖ –ö–≤–∞—Ä—Ç–∞–ª—å–Ω–∞—è<br>(799‚ÇΩ / 3 –º–µ—Å—è—Ü–∞)"]
    SubPlans --> Yearly["üìÖ –ì–æ–¥–æ–≤–∞—è<br>(2999‚ÇΩ / –≥–æ–¥)"]
    
    Trial --> TrialCheck{"–£–∂–µ –±—ã–ª–∞<br>–ø—Ä–æ–±–Ω–∞—è?"}
    TrialCheck -->|"–ù–µ—Ç"| CreateTrial["‚úÖ –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–±–Ω—É—é<br>–ø–æ–¥–ø–∏—Å–∫—É"]
    TrialCheck -->|"–î–∞"| TrialDenied["‚ö†Ô∏è –ü—Ä–æ–±–Ω–∞—è —É–∂–µ –±—ã–ª–∞<br>–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞—Ç–Ω—É—é"]
    
    Monthly --> PaymentFlow["üí≥ –í–´–ë–û–† –°–ü–û–°–û–ë–ê –û–ü–õ–ê–¢–´"]
    Quarterly --> PaymentFlow
    Yearly --> PaymentFlow
    
    PaymentFlow --> Card["üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞"]
    PaymentFlow --> SBP["‚ö° –°–ë–ü"]
    PaymentFlow --> Wallet["üíº –ö–æ—à–µ–ª—å–∫–∏ (–ÆMoney)"]
    PaymentFlow --> Crypto["‚Çø –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞"]
    
    Card --> YooKassa["YooKassa API<br>–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞"]
    SBP --> YooKassa
    Wallet --> YooKassa
    Crypto --> CoinGate["CoinGate API<br>–ö—Ä–∏–ø—Ç–æ –ø–ª–∞—Ç–µ–∂"]
    
    CreateTrial --> VPNGeneration["üîë –ì–µ–Ω–µ—Ä–∞—Ü–∏—è VPN –∫–ª—é—á–∞<br>+ 3X-UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è"]
    YooKassa --> VPNGeneration
    CoinGate --> VPNGeneration
    
    style Trial fill:#10b981,stroke:#059669,color:white
    style PaymentFlow fill:#8b5cf6,stroke:#7c3aed,color:white
    style VPNGeneration fill:#f59e0b,stroke:#d97706,color:white
```

### 3. üîê VPN –î–µ–π—Å—Ç–≤–∏—è (VPN Actions Menu)
**Handler**: `vpn_actions.py`

```mermaid
graph TD
    VPNActions["üîê VPN –î–ï–ô–°–¢–í–ò–Ø"] --> GetConfig["üì± –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"]
    VPNActions --> GetQR["üì∑ QR-–∫–æ–¥"]
    VPNActions --> RegenKey["üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∫–ª—é—á"]
    VPNActions --> VPNStats["üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ VPN"]
    
    GetConfig --> ConfigFile["üìÑ –û—Ç–ø—Ä–∞–≤–∫–∞ .txt —Ñ–∞–π–ª–∞<br>+ –ø–æ–∫–∞–∑ VLESS URL"]
    GetQR --> QRImage["üì± –û—Ç–ø—Ä–∞–≤–∫–∞ QR PNG<br>+ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è"]
    RegenKey --> NewKey["üîÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ UUID<br>+ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä–æ–≥–æ"]
    VPNStats --> StatsDisplay["üìä –¢—Ä–∞—Ñ–∏–∫ / –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è<br>/ –í—Ä–µ–º—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"]
    
    ConfigFile --> BackToActions["‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ VPN –¥–µ–π—Å—Ç–≤–∏—è–º"]
    QRImage --> BackToActions
    NewKey --> BackToActions
    StatsDisplay --> BackToActions
    
    style GetConfig fill:#3b82f6,stroke:#2563eb,color:white
    style GetQR fill:#8b5cf6,stroke:#7c3aed,color:white
    style RegenKey fill:#f59e0b,stroke:#d97706,color:white
    style VPNStats fill:#10b981,stroke:#059669,color:white
```

### 4. üë®‚Äçüíª –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
**Handler**: `admin/admin_panel.py`, `admin/user_management.py`, `admin/subscription_management.py`

```mermaid
graph TD
    AdminPanel["üë®‚Äçüíª –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨"] --> AdminStats["üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã"]
    AdminPanel --> UserMgmt["üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"]
    AdminPanel --> SubMgmt["üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏"]
    AdminPanel --> UserSearch["üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"]
    AdminPanel --> GiveSub["üéÅ –í—ã–¥–∞—á–∞ –ø–æ–¥–ø–∏—Å–∫–∏"]
    AdminPanel --> SysInfo["‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ"]
    
    %% –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
    AdminStats --> StatsData["üìà –û–±—â–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:<br>‚Ä¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–≤—Å–µ–≥–æ/–∞–∫—Ç–∏–≤–Ω—ã—Ö)<br>‚Ä¢ –ü–æ–¥–ø–∏—Å–∫–∏ –ø–æ —Ç–∏–ø–∞–º<br>‚Ä¢ –î–æ—Ö–æ–¥—ã (–æ–±—â–∏–π/—Å–µ–≥–æ–¥–Ω—è)<br>‚Ä¢ VPN –∫–ª—é—á–∏"]
    
    %% –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
    UserMgmt --> UsersList["üìã –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π<br>+ –ø–∞–≥–∏–Ω–∞—Ü–∏—è"]
    UserMgmt --> UserDetail["üë§ –î–µ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br>+ –∏—Å—Ç–æ—Ä–∏—è –ø–æ–¥–ø–∏—Å–æ–∫"]
    UserMgmt --> UserActions["‚öôÔ∏è –î–µ–π—Å—Ç–≤–∏—è:<br>‚Ä¢ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å<br>‚Ä¢ –£–¥–∞–ª–∏—Ç—å<br>‚Ä¢ –ò–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"]
    
    %% –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
    SubMgmt --> SubsList["üìã –°–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å–æ–∫<br>+ —Ñ–∏–ª—å—Ç—Ä—ã"]
    SubMgmt --> SubDetail["üìã –î–µ—Ç–∞–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∏<br>+ VPN –∫–ª—é—á–∏"]
    SubMgmt --> SubActions["‚öôÔ∏è –î–µ–π—Å—Ç–≤–∏—è:<br>‚Ä¢ –ü—Ä–æ–¥–ª–∏—Ç—å<br>‚Ä¢ –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å<br>‚Ä¢ –ò–∑–º–µ–Ω–∏—Ç—å —Ç–∞—Ä–∏—Ñ"]
    
    %% –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    UserSearch --> SearchInput["üîç –í–≤–æ–¥ –∑–∞–ø—Ä–æ—Å–∞:<br>‚Ä¢ Telegram ID<br>‚Ä¢ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br>‚Ä¢ Username"]
    SearchInput --> SearchResults["üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞<br>+ –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è"]
    
    %% –í—ã–¥–∞—á–∞ –ø–æ–¥–ø–∏—Å–∫–∏
    GiveSub --> GiveInput["üë§ –í–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br>(Telegram ID)"]
    GiveInput --> GiveSelect["üìã –í—ã–±–æ—Ä —Ç–∏–ø–∞ –ø–æ–¥–ø–∏—Å–∫–∏<br>+ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è"]
    GiveSelect --> GiveConfirm["‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–¥–∞—á–∏<br>+ —Å–æ–∑–¥–∞–Ω–∏–µ VPN –∫–ª—é—á–∞"]
    
    style AdminPanel fill:#6366f1,stroke:#4f46e5,color:white
    style UserMgmt fill:#8b5cf6,stroke:#7c3aed,color:white
    style SubMgmt fill:#f59e0b,stroke:#d97706,color:white
    style UserSearch fill:#10b981,stroke:#059669,color:white
```

## üì± –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–ï –ü–£–¢–ò (User Journeys)

### üÜì –ü—É—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Trial)

```mermaid
sequenceDiagram
    participant U as üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant B as ü§ñ –ë–æ—Ç
    participant S as üíæ LocalStorage
    participant X as üîß 3X-UI
    
    U->>B: /start
    B->>B: Mock –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
    B->>U: üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    U->>B: üí≥ –ü–æ–¥–ø–∏—Å–∫–∏
    B->>U: üìã –í—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞
    U->>B: üÜì –ü—Ä–æ–±–Ω–∞—è
    B->>S: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ trial
    S->>B: ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å
    B->>S: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ + VPN –∫–ª—é—á–∞
    B->>X: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ 3X-UI
    X->>B: ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω
    B->>U: üéâ Trial –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω + VLESS –∫–ª—é—á
```

### üí≥ –ü—É—Ç—å –ø–æ–∫—É–ø–∫–∏ –ø–ª–∞—Ç–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏

```mermaid
sequenceDiagram
    participant U as üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant B as ü§ñ –ë–æ—Ç
    participant S as üíæ LocalStorage
    participant Y as üí≥ YooKassa
    participant X as üîß 3X-UI
    
    U->>B: üí≥ –ü–æ–¥–ø–∏—Å–∫–∏ ‚Üí üìÖ –ú–µ—Å—è—á–Ω–∞—è
    B->>U: üí≥ –í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
    U->>B: üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞
    B->>Y: –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
    Y->>U: üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É
    U->>Y: üí∞ –û–ø–ª–∞—Ç–∞
    Y->>B: ‚úÖ –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–µ–Ω
    B->>S: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ + VPN –∫–ª—é—á–∞
    B->>X: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ 3X-UI
    B->>U: üéâ –ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ + VLESS –∫–ª—é—á
```

### üîê –ü—É—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è VPN

```mermaid
sequenceDiagram
    participant U as üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant B as ü§ñ –ë–æ—Ç
    participant S as üíæ LocalStorage
    
    U->>B: üîê –ú–æ–π VPN
    B->>S: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
    S->>B: ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞
    B->>S: –ü–æ–ª—É—á–µ–Ω–∏–µ VPN –∫–ª—é—á–µ–π
    S->>B: üîë VPN –∫–ª—é—á –Ω–∞–π–¥–µ–Ω
    B->>U: üîê VPN –º–µ–Ω—é —Å –¥–∞–Ω–Ω—ã–º–∏
    U->>B: üì± –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    B->>U: üìÑ .txt —Ñ–∞–π–ª + VLESS URL
    
    Note over U,B: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ:
    U->>B: üì∑ QR-–∫–æ–¥
    B->>U: üì± PNG QR-–∫–æ–¥ + –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
```

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### FSM States (–ö–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–π)

```python
# AdminStates (admin/admin_panel.py)
class AdminStates(StatesGroup):
    waiting_for_search = State()      # –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
    waiting_for_user_id = State()     # –û–∂–∏–¥–∞–Ω–∏–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    users_menu = State()              # –ú–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    users_list = State()              # –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    user_detail = State()             # –î–µ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    subscriptions_menu = State()      # –ú–µ–Ω—é –ø–æ–¥–ø–∏—Å–æ–∫
    subscriptions_list = State()      # –°–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å–æ–∫
    subscription_detail = State()     # –î–µ—Ç–∞–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∏
    subscription_create = State()     # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
```

### Callback Data Mapping

```python
# –û—Å–Ω–æ–≤–Ω—ã–µ callback'–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
MAIN_MENU_CALLBACKS = {
    "my_vpn": "üîê –ú–æ–π VPN",
    "subscriptions": "üí≥ –ü–æ–¥–ø–∏—Å–∫–∏", 
    "statistics": "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
    "payments": "üí∞ –ü–ª–∞—Ç–µ–∂–∏",
    "profile": "üë§ –ü—Ä–æ—Ñ–∏–ª—å",
    "support": "üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞",
    "help": "‚ÑπÔ∏è –ü–æ–º–æ—â—å",
    "admin_panel": "üë®‚Äçüíª –ê–¥–º–∏–Ω"
}

# –ü–æ–¥–ø–∏—Å–∫–∏
SUBSCRIPTION_CALLBACKS = {
    "trial_subscription": "üÜì –ü—Ä–æ–±–Ω–∞—è",
    "monthly_subscription": "üìÖ –ú–µ—Å—è—á–Ω–∞—è",
    "quarterly_subscription": "üìÖ –ö–≤–∞—Ä—Ç–∞–ª—å–Ω–∞—è", 
    "yearly_subscription": "üìÖ –ì–æ–¥–æ–≤–∞—è"
}

# –°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã
PAYMENT_CALLBACKS = {
    "payment_card": "üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞",
    "payment_sbp": "‚ö° –°–ë–ü", 
    "payment_yoomoney": "üíº –ÆMoney",
    "payment_crypto": "‚Çø –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞"
}

# VPN –¥–µ–π—Å—Ç–≤–∏—è
VPN_ACTION_CALLBACKS = {
    "get_config": "üì± –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é",
    "get_qr": "üì∑ QR-–∫–æ–¥",
    "regenerate_key": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∫–ª—é—á",
    "vpn_stats": "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ VPN"
}

# –ê–¥–º–∏–Ω—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
ADMIN_CALLBACKS = {
    "admin_stats": "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã",
    "admin_users": "üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏",
    "admin_subscriptions": "üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏",
    "admin_user_search": "üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
    "admin_give_subscription": "üéÅ –í—ã–¥–∞—á–∞ –ø–æ–¥–ø–∏—Å–∫–∏",
    "admin_page_info": "‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ"
}
```

### –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏

```python
# –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞
NAVIGATION_CALLBACKS = {
    "back_to_main": "‚Ü©Ô∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
    "back_to_subscriptions": "‚Ü©Ô∏è –ö –ø–æ–¥–ø–∏—Å–∫–∞–º", 
    "back_to_vpn": "‚Ü©Ô∏è –ö VPN –¥–µ–π—Å—Ç–≤–∏—è–º",
    "admin_back_to_menu": "‚Ü©Ô∏è –ê–¥–º–∏–Ω –º–µ–Ω—é"
}
```

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –°–¢–†–£–ö–¢–£–†–´ –ú–ï–ù–Æ

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–í—Å–µ–≥–æ –ø—É–Ω–∫—Ç–æ–≤ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é**: 8
- **–í—Å–µ–≥–æ callback handlers**: 45+
- **FSM —Å–æ—Å—Ç–æ—è–Ω–∏–π**: 9 (AdminStates)
- **–¢–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤**: 4
- **–°–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã**: 4  
- **VPN –¥–µ–π—Å—Ç–≤–∏–π**: 4
- **–ê–¥–º–∏–Ω—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π**: 6
- **–§–∞–π–ª–æ–≤ handlers**: 7
- **Keyboard –º–æ–¥—É–ª–µ–π**: 2

### –ì–ª—É–±–∏–Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞**: 4 —É—Ä–æ–≤–Ω—è (–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí –ü–æ–¥–ø–∏—Å–∫–∏ ‚Üí –û–ø–ª–∞—Ç–∞ ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)
- **–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤ –¥–æ —Ü–µ–ª–∏**: 2-3
- **–¢–æ—á–µ–∫ –≤–æ–∑–≤—Ä–∞—Ç–∞**: 15+ –∫–Ω–æ–ø–æ–∫ "‚Ü©Ô∏è –ù–∞–∑–∞–¥"

## üéØ –†–ï–ó–Æ–ú–ï –°–¢–†–£–ö–¢–£–†–´

VPN Telegram –±–æ—Ç –∏–º–µ–µ—Ç **—Ö–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é** —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —á–∞—Å—Ç—å**: –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –∏ VPN –∫–ª—é—á–∞–º–∏
2. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è —á–∞—Å—Ç—å**: –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏  
3. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å**: Mock –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è + LocalStorage + 3X-UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
4. **–ü–ª–∞—Ç–µ–∂–Ω–∞—è —á–∞—Å—Ç—å**: 4 —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ YooKassa –∏ CoinGate

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç**:
- ‚úÖ Scalability (–ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)
- ‚úÖ Maintainability (—á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ handlers)
- ‚úÖ User Experience (–ª–æ–≥–∏—á–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è)
- ‚úÖ Admin Capabilities (–ø–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π) 